# SOM Tier-0 Environment Configuration
# DoD C-ATO Compliance (IL4/IL5)
#
# SECURITY NOTICE:
# - NEVER commit .env files to version control
# - Rotate secrets regularly (at least every 90 days for DoD compliance)
# - Use strong, cryptographically random values
# - Store production secrets in secure vault (e.g., HashiCorp Vault, AWS Secrets Manager)

# ==================== Application ====================

# Environment: development | staging | production
NODE_ENV=development

# Server Port
PORT=3333

# ==================== Database ====================

# Database Path (SQLite)
DB_PATH=./som.db

# Database SSL Mode (required in production)
DATABASE_SSL_MODE=require

# ==================== Authentication ====================
# NIST 800-53: IA-2 (Identification/Authentication), IA-5 (Authenticator Management)

# JWT Secret (generate with: openssl rand -base64 32)
# REQUIRED: Must be at least 32 characters (256 bits)
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# JWT Access Token Expiry (seconds, DoD standard: 900 = 15 minutes)
JWT_ACCESS_TOKEN_EXPIRY=900

# JWT Refresh Token Expiry (seconds, DoD standard: 28800 = 8 hours)
JWT_REFRESH_TOKEN_EXPIRY=28800

# JWT Algorithm (HS256 for FIPS compliance)
JWT_ALGORITHM=HS256

# ==================== Session Management ====================
# NIST 800-53: AC-12 (Session Termination), AC-11 (Device Lock)

# Session Timeout due to inactivity (seconds, DoD standard: 900 = 15 minutes)
SESSION_INACTIVITY_TIMEOUT=900

# Maximum Session Duration (seconds, DoD standard: 28800 = 8 hours)
MAX_SESSION_DURATION=28800

# ==================== Account Lockout ====================
# NIST 800-53: AC-7 (Unsuccessful Logon Attempts)

# Maximum failed login attempts before lockout (DoD standard: 3)
MAX_FAILED_LOGIN_ATTEMPTS=3

# Account lockout duration (seconds, DoD standard: 900 = 15 minutes)
ACCOUNT_LOCKOUT_DURATION=900

# Failed attempt window (seconds, 900 = 15 minutes)
# Attempts within this window count toward lockout
FAILED_ATTEMPT_WINDOW=900

# ==================== Security Headers ====================

# Enable HSTS (HTTP Strict Transport Security)
ENABLE_HSTS=true

# HSTS Max Age (1 year in seconds)
HSTS_MAX_AGE=31536000

# Enable Content Security Policy
ENABLE_CSP=true

# CSP Report URI (for violation reports)
CSP_REPORT_URI=/api/v1/csp-report

# ==================== CORS Configuration ====================

# Allowed Origins (comma-separated, use specific domains in production)
# Production example: https://app.your-domain.mil,https://admin.your-domain.mil
CORS_ORIGINS=*

# ==================== Audit Logging ====================

# Log Level: debug | info | warn | error
LOG_LEVEL=info

# Audit Log Path (must be append-only in production)
AUDIT_LOG_PATH=/var/log/som-tier0/audit.log

# SIEM Endpoint (Splunk, ELK, etc.)
SIEM_ENDPOINT=https://splunk.your-domain.mil

# SIEM API Key (if required)
# SIEM_API_KEY=

# ==================== Rate Limiting ====================

# Maximum requests per minute per client
RATE_LIMIT_MAX_REQUESTS=100

# Rate limit window (milliseconds)
RATE_LIMIT_WINDOW=60000

# ==================== Encryption ====================

# Encryption Key (AES-256, generate with: openssl rand -base64 32)
# REQUIRED: Change this value!
ENCRYPTION_KEY=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# ==================== TLS/SSL Configuration ====================
# NIST 800-53: SC-8 (Transmission Confidentiality)

# Enable HTTPS (required for production)
ENABLE_HTTPS=false

# HTTPS Port (default: 3443)
HTTPS_PORT=3443

# HTTP Port for redirect (default: 3080)
# Only used if ENABLE_HTTPS=true and ENABLE_HTTP_REDIRECT=true
HTTP_PORT=3080

# Enable HTTP to HTTPS redirect (default: true if HTTPS enabled)
ENABLE_HTTP_REDIRECT=true

# TLS Minimum Version (DoD requires TLSv1.2 minimum, TLSv1.3 preferred)
TLS_MIN_VERSION=TLSv1.3

# TLS Maximum Version
TLS_MAX_VERSION=TLSv1.3

# Certificate Paths (required if ENABLE_HTTPS=true)
# For development: Run `npm run generate-certs` to create self-signed certificates
# For production: Use certificates from DoD-approved CA
TLS_CERT_PATH=./certs/server.crt
TLS_KEY_PATH=./certs/server.key
# TLS_CA_PATH=./certs/ca.crt

# ==================== CAC/PIV Integration ====================

# Enable CAC/PIV authentication
ENABLE_CAC_AUTH=false

# CAC Certificate Validation Endpoint
# CAC_VALIDATION_ENDPOINT=https://cac-validator.your-domain.mil

# ==================== Monitoring & Health ====================

# Enable health check endpoints
ENABLE_HEALTH_CHECKS=true

# Health check authentication (disable for k8s probes)
HEALTH_CHECK_REQUIRE_AUTH=false

# ==================== DoD Specific ====================

# Impact Level (IL4 | IL5 | IL6)
IMPACT_LEVEL=IL4

# C-ATO ID (from ATO package)
# CATO_ID=

# ISSM Contact
# ISSM_EMAIL=issm@your-domain.mil

# ==================== Development Only ====================
# These settings should NOT be used in production

# Enable debug logging
# DEBUG=som:*

# Disable security features (NEVER in production!)
# DISABLE_SECURITY_HEADERS=false
# DISABLE_AUDIT_LOGGING=false

# Development API Key (for testing only)
DEV_API_KEY=dev-token-123
