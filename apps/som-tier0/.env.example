# SOM Tier-0 Environment Configuration
# DoD C-ATO Compliance (IL4/IL5)
#
# SECURITY NOTICE:
# - NEVER commit .env files to version control
# - Rotate secrets regularly (at least every 90 days for DoD compliance)
# - Use strong, cryptographically random values
# - Store production secrets in secure vault (e.g., HashiCorp Vault, AWS Secrets Manager)

# ==================== Application ====================

# Environment: development | staging | production
NODE_ENV=development

# Server Port
PORT=3333

# ==================== Database ====================

# Database Path (SQLite)
DB_PATH=./som.db

# Database SSL Mode (required in production)
DATABASE_SSL_MODE=require

# ==================== Authentication ====================

# JWT Secret (generate with: openssl rand -base64 32)
# REQUIRED: Change this value!
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# JWT Expiry (DoD standard: 15 minutes for session tokens)
JWT_EXPIRY=15m

# Refresh Token Expiry (DoD standard: 8 hours max)
REFRESH_TOKEN_EXPIRY=8h

# ==================== Session Management ====================

# Session Secret (generate with: openssl rand -base64 32)
# REQUIRED: Change this value!
SESSION_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# Session Timeout (15 minutes in milliseconds - DoD standard)
SESSION_TIMEOUT=900000

# Max Session Duration (8 hours in milliseconds - DoD standard)
MAX_SESSION_DURATION=28800000

# ==================== Security Headers ====================

# Enable HSTS (HTTP Strict Transport Security)
ENABLE_HSTS=true

# HSTS Max Age (1 year in seconds)
HSTS_MAX_AGE=31536000

# Enable Content Security Policy
ENABLE_CSP=true

# CSP Report URI (for violation reports)
CSP_REPORT_URI=/api/v1/csp-report

# ==================== CORS Configuration ====================

# Allowed Origins (comma-separated, use specific domains in production)
# Production example: https://app.your-domain.mil,https://admin.your-domain.mil
CORS_ORIGINS=*

# ==================== Audit Logging ====================

# Log Level: debug | info | warn | error
LOG_LEVEL=info

# Audit Log Path (must be append-only in production)
AUDIT_LOG_PATH=/var/log/som-tier0/audit.log

# SIEM Endpoint (Splunk, ELK, etc.)
SIEM_ENDPOINT=https://splunk.your-domain.mil

# SIEM API Key (if required)
# SIEM_API_KEY=

# ==================== Rate Limiting ====================

# Maximum requests per minute per client
RATE_LIMIT_MAX_REQUESTS=100

# Rate limit window (milliseconds)
RATE_LIMIT_WINDOW=60000

# ==================== Encryption ====================

# Encryption Key (AES-256, generate with: openssl rand -base64 32)
# REQUIRED: Change this value!
ENCRYPTION_KEY=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_32

# ==================== TLS/SSL Configuration ====================

# TLS Minimum Version (for Node.js TLS: TLSv1.2 or TLSv1.3)
TLS_MIN_VERSION=TLSv1.3

# Certificate Path (for HTTPS server)
# TLS_CERT_PATH=/path/to/cert.pem
# TLS_KEY_PATH=/path/to/key.pem
# TLS_CA_PATH=/path/to/ca.pem

# ==================== CAC/PIV Integration ====================

# Enable CAC/PIV authentication
ENABLE_CAC_AUTH=false

# CAC Certificate Validation Endpoint
# CAC_VALIDATION_ENDPOINT=https://cac-validator.your-domain.mil

# ==================== Monitoring & Health ====================

# Enable health check endpoints
ENABLE_HEALTH_CHECKS=true

# Health check authentication (disable for k8s probes)
HEALTH_CHECK_REQUIRE_AUTH=false

# ==================== DoD Specific ====================

# Impact Level (IL4 | IL5 | IL6)
IMPACT_LEVEL=IL4

# C-ATO ID (from ATO package)
# CATO_ID=

# ISSM Contact
# ISSM_EMAIL=issm@your-domain.mil

# ==================== Development Only ====================
# These settings should NOT be used in production

# Enable debug logging
# DEBUG=som:*

# Disable security features (NEVER in production!)
# DISABLE_SECURITY_HEADERS=false
# DISABLE_AUDIT_LOGGING=false

# Development API Key (for testing only)
DEV_API_KEY=dev-token-123
